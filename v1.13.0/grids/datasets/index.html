<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Writing datasets · WriteVTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://jipolanco.github.io/WriteVTK.jl/grids/datasets/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="../../assets/tomate.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WriteVTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Grid formats</span><ul><li><a class="tocitem" href="../syntax/">General syntax</a></li><li><a class="tocitem" href="../structured/">Structured grid formats</a></li><li><a class="tocitem" href="../unstructured/">Unstructured grid formats</a></li><li class="is-active"><a class="tocitem" href>Writing datasets</a><ul class="internal"><li><a class="tocitem" href="#Passing-tuples-of-arrays"><span>Passing tuples of arrays</span></a></li><li><a class="tocitem" href="#Passing-arrays-of-static-arrays"><span>Passing arrays of static arrays</span></a></li><li><a class="tocitem" href="#Dataset-types"><span>Dataset types</span></a></li></ul></li></ul></li><li><span class="tocitem">Metadata formats</span><ul><li><a class="tocitem" href="../../metadata/multiblock/">Multiblock files</a></li><li><a class="tocitem" href="../../metadata/paraview_collections/">ParaView collections</a></li><li><a class="tocitem" href="../../metadata/parallel/">Parallel files</a></li></ul></li><li><span class="tocitem">Additional tools</span><ul><li><a class="tocitem" href="../../tools/write_array/">Visualising Julia arrays</a></li><li><a class="tocitem" href="../../tools/readvtk/">Reading VTK files</a></li></ul></li><li><a class="tocitem" href="../../API/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Grid formats</a></li><li class="is-active"><a href>Writing datasets</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Writing datasets</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jipolanco/WriteVTK.jl/blob/master/docs/src/grids/datasets.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Writing-datasets"><a class="docs-heading-anchor" href="#Writing-datasets">Writing datasets</a><a id="Writing-datasets-1"></a><a class="docs-heading-anchor-permalink" href="#Writing-datasets" title="Permalink"></a></h1><p>In VTK files, datasets represent scalar, vector or tensor quantities that one may want to visualise. These quantities are generally attached to either grid points or cells.</p><p>The simplest syntax for writing datasets to a file is as follows:</p><pre><code class="language-julia hljs">x, y, z = 0:10, 1:6, 2:0.1:3
Nx, Ny, Nz = length(x), length(y), length(z)

vtk_grid(&quot;fields&quot;, x, y, z) do vtk
    vtk[&quot;Temperature&quot;] = rand(Nx, Ny, Nz)              # scalar field attached to points
    vtk[&quot;Pressure&quot;] = rand(Nx - 1, Ny - 1, Nz - 1)     # scalar field attached to cells
    vtk[&quot;Velocity&quot;] = rand(3, Nx, Ny, Nz)              # vector field attached to points
    vtk[&quot;VelocityGradients&quot;] = rand(3, 3, Nx, Ny, Nz)  # 3×3 tensor field attached to points
    vtk[&quot;date&quot;] = &quot;31/10/2021&quot;                         # metadata (&quot;field data&quot; in VTK)
    vtk[&quot;time&quot;] = 0.42                                 # metadata (&quot;field data&quot; in VTK)
end</code></pre><p>In the above example, WriteVTK automatically decides whether data is to be attached to grid points or to grid cells depending on the dimensions of the input. In particular, note that the <code>Pressure</code> field is attached to cells instead of points, since it has dimensions <span>$(N_x - 1) × (N_y - 1) × (N_z - 1)$</span>, which is the number of cells in structured files (see <a href="../structured/#Cells-in-structured-formats">Cells in structured formats</a>). For more control, see <a href="#Dataset-types">Dataset types</a> below.</p><h2 id="Passing-tuples-of-arrays"><a class="docs-heading-anchor" href="#Passing-tuples-of-arrays">Passing tuples of arrays</a><a id="Passing-tuples-of-arrays-1"></a><a class="docs-heading-anchor-permalink" href="#Passing-tuples-of-arrays" title="Permalink"></a></h2><p>Note that, in the example above, the <code>Velocity</code> vector field is passed as a single <span>$3 × N_x × N_y × N_z$</span> array, which is the layout ultimately used in VTK formats. In some applications, one may instead prefer to work with vector fields as a collection of separate scalar fields, or similarly as an array of dimensions <span>$N_x × N_y × N_z × 3$</span>.</p><p>To avoid unnecessary allocations in transposing the data to <span>$3 × N_x × N_y × N_z$</span> format, WriteVTK also allows passing vector and tensor fields as tuples of arrays. For example:</p><pre><code class="language-julia hljs">x, y, z = 0:10, 1:6, 2:0.1:3
Nx, Ny, Nz = length(x), length(y), length(z)
vx, vy, vz = rand(Nx, Ny, Nz), rand(Nx, Ny, Nz), rand(Nx, Ny, Nz)  # vector as separate fields
ω = rand(Nx, Ny, Nz, 3)
∇v = rand(Nx, Ny, Nz, 3, 3)

vtk_grid(&quot;fields_tuples&quot;, x, y, z) do vtk
    # Pass vectors as tuples of scalars
    vtk[&quot;Velocity&quot;] = (vx, vy, vz)
    vtk[&quot;Vorticity&quot;] = @views (ω[:, :, :, 1], ω[:, :, :, 2], ω[:, :, :, 3])

    # Similarly for tensors
    vtk[&quot;VelocityGradients&quot;] = @views (
        ∇v[:, :, :, 1, 1], ∇v[:, :, :, 2, 1], ∇v[:, :, :, 3, 1],
        ∇v[:, :, :, 1, 2], ∇v[:, :, :, 2, 2], ∇v[:, :, :, 3, 2],
        ∇v[:, :, :, 1, 3], ∇v[:, :, :, 2, 3], ∇v[:, :, :, 3, 3],
    )
end</code></pre><h2 id="Passing-arrays-of-static-arrays"><a class="docs-heading-anchor" href="#Passing-arrays-of-static-arrays">Passing arrays of static arrays</a><a id="Passing-arrays-of-static-arrays-1"></a><a class="docs-heading-anchor-permalink" href="#Passing-arrays-of-static-arrays" title="Permalink"></a></h2><p>Alternatively, a common use case is to store vector fields as arrays of static arrays, using the <a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays</a> package. This use case is naturally supported by WriteVTK:</p><pre><code class="language-julia hljs">using StaticArrays

x, y, z = 0:10, 1:6, 2:0.1:3
Nx, Ny, Nz = length(x), length(y), length(z)
v = rand(SVector{3, Float64}, Nx, Ny, Nz)
∇v = rand(SMatrix{3, 3, Float32, 9}, Nx, Ny, Nz)

vtk_grid(&quot;fields_sarray&quot;, x, y, z) do vtk
    vtk[&quot;Velocity&quot;] = v
    vtk[&quot;VelocityGradients&quot;] = ∇v
end</code></pre><p>One may also specify grid coordinates using arrays of static arrays:</p><pre><code class="language-julia hljs">using StaticArrays

Nx, Ny, Nz = 5, 6, 10
xs = [SVector(sqrt(i) + 2j + 3k, 2i - j + k, -i + 3j - k)
      for i = 1:Nx, j = 1:Ny, k = 1:Nz]

vtk_grid(&quot;coords_sarray&quot;, xs) do vtk
    # add datasets here...
end</code></pre><div class="admonition is-info"><header class="admonition-header">(Lack of) dependencies</header><div class="admonition-body"><p>Note that the WriteVTK package does not directly depend on StaticArrays, as there is no StaticArrays-specific implementation allowing for the functionality described in this section. Instead, the implementation is quite generic, and the above may also work with array types that behave similarly to StaticArrays.</p></div></div><h2 id="Dataset-types"><a class="docs-heading-anchor" href="#Dataset-types">Dataset types</a><a id="Dataset-types-1"></a><a class="docs-heading-anchor-permalink" href="#Dataset-types" title="Permalink"></a></h2><p>The syntax exposed above is high-level, in the sense that WriteVTK automatically decides on the type of dataset depending on the dimensions of the input data.</p><p>The VTK format defines three different kinds of dataset:</p><ul><li><a href="../../API/#WriteVTK.VTKPointData"><code>VTKPointData</code></a> for data attached to grid points,</li><li><a href="../../API/#WriteVTK.VTKCellData"><code>VTKCellData</code></a> for data attached to grid cells,</li><li><a href="../../API/#WriteVTK.VTKFieldData"><code>VTKFieldData</code></a> for everything else. This may be used to store lightweight metadata, such as time information or strings.</li></ul><p>For more control, one can explicitly pass an instance of <code>VTKPointData</code>, <code>VTKCellData</code> and <code>VTKFieldData</code> when adding a dataset to a VTK file.</p><p>For example:</p><pre><code class="language-julia hljs">x, y, z = 0:10, 1:6, 2:0.1:3
Nx, Ny, Nz = length(x), length(y), length(z)

vtk_grid(&quot;fields_explicit&quot;, x, y, z) do vtk
    vtk[&quot;Temperature&quot;, VTKPointData()] = rand(Nx, Ny, Nz)
    vtk[&quot;Pressure&quot;, VTKCellData()] = rand(Nx - 1, Ny - 1, Nz - 1)
    vtk[&quot;Velocity&quot;, VTKPointData()] = rand(3, Nx, Ny, Nz)
    vtk[&quot;VelocityGradients&quot;, VTKPointData()] = rand(3, 3, Nx, Ny, Nz)
    vtk[&quot;date&quot;, VTKFieldData()] = &quot;31/10/2021&quot;
    vtk[&quot;time&quot;, VTKFieldData()] = 0.42
end</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../unstructured/">« Unstructured grid formats</a><a class="docs-footer-nextpage" href="../../metadata/multiblock/">Multiblock files »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 12 January 2022 22:38">Wednesday 12 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
